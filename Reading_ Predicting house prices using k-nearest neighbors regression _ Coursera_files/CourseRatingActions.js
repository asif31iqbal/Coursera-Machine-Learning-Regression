define("bundles/content-feedback/actions/CourseRatingActions",["require","exports","module","bundles/content-feedback/models/CourseRatingStats","bundles/content-feedback/models/RatingFeedback","bundles/content-feedback/utils/CourseRatingAPIUtils"],function(require,exports,module){"use strict";var t=require("bundles/content-feedback/models/CourseRatingStats"),n=require("bundles/content-feedback/models/RatingFeedback"),e=require("bundles/content-feedback/utils/CourseRatingAPIUtils");exports.getCourseReviews=function(i,t){var a=t.courseId,n=t.reviewCollection,r=t.ratingValue,o=t.learnerAudience;return i.dispatch("GET_REVIEWS",{reviewCollection:n}),e.getReviews(a,o,n.page,r.value).then(function(e){var t=e.feedbacks,a=e.totalCount;i.dispatch("RECEIVE_REVIEWS",{reviewCollection:n,feedbacks:t,totalCount:a})}).done()},exports.filterCourseReviews=function(e,t){var a=t.courseId,n=t.ratingValue,r=t.learnerAudience,o=e.getStore("CourseRatingStore");e.dispatch("FILTER_REVIEWS",{ratingValue:n});var i=o.getReviewCollection();i.isEmpty()&&e.executeAction(exports.getCourseReviews,{courseId:a,reviewCollection:i,ratingValue:n,learnerAudience:r})},exports.getCourseRatingStats=function(i,n){var a=n.courseId,r=n.learnerAudience;return e.getRatingStats(a,r).then(function(e){var n=new t(e);i.dispatch("RECEIVE_COURSE_RATING_STATS",{courseRatingStats:n})}).done()},exports.filterCourseRatings=function(e,t){var i=t.courseId,o=t.ratingValue,n=t.learnerAudience,a=e.getStore("CourseRatingStore");e.dispatch("FILTER_RATINGS",{learnerAudience:n});var r=a.getReviewCollection(),c=a.getCourseRatingStats();r.isEmpty()&&e.executeAction(exports.getCourseReviews,{courseId:i,reviewCollection:r,ratingValue:o,learnerAudience:n}),c||e.executeAction(exports.getCourseRatingStats,{courseId:i,learnerAudience:n})},exports.receiveMyCourseRating=function(e,t){var n=t.ratingFeedback;e.dispatch("RECEIVE_MY_RATING",{ratingFeedback:n})},exports.postMyCourseRating=function(a,t){var r=t.courseId,o=t.value,c=t.active,u=t.comment,i=new n(o,c,u);return a.executeAction(exports.receiveMyCourseRating,{ratingFeedback:i}),e.postFeedback(r,i)},exports.deleteFeedback=function(n,t){return e.deleteFeedback(t).then(function(){n.dispatch("DELETE_FEEDBACK",t)}).done()}});